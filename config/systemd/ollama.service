[Unit]
Description=Ollama AI Engine for PiClaw
Documentation=https://ollama.com
After=network-online.target
Wants=network-online.target

[Service]
Type=simple
User=root
Group=root
ExecStart=/usr/local/bin/ollama serve
EnvironmentFile=/etc/default/ollama

# Restart policy
Restart=always
RestartSec=5
StartLimitIntervalSec=300
StartLimitBurst=10

# Performance
Nice=-5
IOSchedulingClass=realtime
IOSchedulingPriority=0

# Limiti risorse
LimitNOFILE=65535
LimitNPROC=4096
LimitMEMLOCK=infinity

# Memoria: limita a 3GB su 4GB totali (lascia ~1GB per OS + OpenClaw, ~256MB GPU)
MemoryMax=3G
MemoryHigh=2560M

# Timeout
TimeoutStartSec=60
TimeoutStopSec=30

# Logging
StandardOutput=journal
StandardError=journal
SyslogIdentifier=ollama

[Install]
WantedBy=multi-user.target
